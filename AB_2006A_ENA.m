function [Sa_2 sigma_2] = AB_2006A_ENA(M, T, Rcd)
% by Rocio Segura, 18/10/2016
%
% Implements GMMs developed by Gail M. Atkinson and David M. Boore and published as
% “Earthquake Ground-Motion Prediction Equations for Eastern North America” 
% (2006, Bulletin of the Seismological Society of America, pages 2181--2205). 
% This class implements only the equations for stress parameter of 140 bars

%No site parameters are needed. The GMPE was developed for hard-rock site
% with Vs30 >= 2000 m/s (NEHRP site class A) only.
%
%**************************************************************************
%--------------------------INPUT VARIABLES---------------------------------
% M      = moment magnitude
% T      = period (s); 
% Rcd    = closest distance to fault (km)
%
%--------------------------OUTPUT VARIABLES--------------------------------
% Sa    = median spectral acceleration prediction (g)
% sigma = logarithmic standard deviation of spectral acceleration
%         prediction (g)
%**************************************************************************

%----------------------COEFFICIENTS FOR ROCK SITES ------------------------
% Table of coefficients were provided by Table 6.
period = [999 998 5.000	4.000	3.125	2.500	2.000	1.587	1.250	1.000	0.794	0.629	0.500	0.397	0.315	0.251	0.199	0.158	0.125	0.100	0.079	0.063	0.050	0.040	0.031	0.025]';
  
cr = [-1.44E+00    9.91E-01   -5.85E-02   -2.70E+00    2.16E-01   -2.44E+00     2.66E-01     8.48E-02  -6.93E-02   -3.73E-04
       9.07E-01    9.83E-01   -6.60E-02   -2.70E+00    1.59E-01   -2.80E+00     2.12E-01    -3.01E-01  -6.53E-02   -4.48E-04
      -5.408E+00   1.714E+00  -9.012E-02  -2.537E+00   2.267E-01  -1.268E+00   1.162E-01   9.792E-01  -1.767E-01  -1.757E-04
      -5.791E+00   1.916E+00  -1.071E-01  -2.441E+00   2.113E-01  -1.162E+00   1.018E-01   1.012E+00  -1.824E-01  -2.010E-04
      -6.038E+00   2.080E+00  -1.221E-01  -2.367E+00   2.002E-01  -1.073E+00   8.950E-02   1.002E+00  -1.803E-01  -2.306E-04
      -6.169E+00   2.211E+00  -1.348E-01  -2.299E+00   1.898E-01  -9.860E-01   7.860E-02   9.683E-01  -1.765E-01  -2.823E-04
      -6.183E+00   2.302E+00  -1.442E-01  -2.223E+00   1.770E-01  -9.370E-01   7.067E-02   9.518E-01  -1.768E-01  -3.220E-04
      -6.043E+00   2.342E+00  -1.496E-01  -2.157E+00   1.662E-01  -8.704E-01   6.047E-02   9.207E-01  -1.734E-01  -3.748E-04
      -5.724E+00   2.324E+00  -1.505E-01  -2.104E+00   1.565E-01  -8.202E-01   5.186E-02   8.563E-01  -1.661E-01  -4.329E-04
      -5.272E+00   2.264E+00  -1.483E-01  -2.069E+00   1.497E-01  -8.132E-01   4.666E-02   8.262E-01  -1.622E-01  -4.862E-04
      -4.604E+00   2.132E+00  -1.406E-01  -2.062E+00   1.468E-01  -7.974E-01   4.345E-02   7.748E-01  -1.558E-01  -5.790E-04
      -3.917E+00   1.987E+00  -1.314E-01  -2.045E+00   1.419E-01  -7.818E-01   4.297E-02   7.878E-01  -1.590E-01  -6.948E-04
      -3.216E+00   1.826E+00  -1.201E-01  -2.018E+00   1.344E-01  -8.134E-01   4.437E-02   8.839E-01  -1.751E-01  -7.704E-04
      -2.437E+00   1.649E+00  -1.084E-01  -2.051E+00   1.363E-01  -8.426E-01   4.483E-02   7.386E-01  -1.557E-01  -8.509E-04
      -1.721E+00   1.483E+00  -9.739E-02  -2.080E+00   1.382E-01  -8.893E-01   4.869E-02   6.101E-01  -1.389E-01  -9.538E-04
      -1.121E+00   1.342E+00  -8.722E-02  -2.082E+00   1.349E-01  -9.714E-01   5.628E-02   6.140E-01  -1.432E-01  -1.055E-03
      -6.153E-01   1.227E+00  -7.886E-02  -2.087E+00   1.312E-01  -1.120E+00   6.788E-02   6.055E-01  -1.459E-01  -1.125E-03
      -1.455E-01   1.123E+00  -7.143E-02  -2.116E+00   1.302E-01  -1.303E+00   8.311E-02   5.617E-01  -1.438E-01  -1.182E-03
       2.144E-01   1.054E+00  -6.664E-02  -2.154E+00   1.295E-01  -1.608E+00   1.046E-01   4.273E-01  -1.303E-01  -1.153E-03
       4.797E-01   1.017E+00  -6.404E-02  -2.201E+00   1.270E-01  -2.007E+00   1.326E-01   3.371E-01  -1.266E-01  -1.047E-03
       6.906E-01   9.974E-01  -6.276E-02  -2.262E+00   1.246E-01  -2.487E+00   1.636E-01   2.139E-01  -1.207E-01  -8.469E-04
       9.109E-01   9.802E-01  -6.208E-02  -2.360E+00   1.263E-01  -2.972E+00   1.910E-01   1.069E-01  -1.173E-01  -5.786E-04
       1.105E+00   9.719E-01  -6.197E-02  -2.466E+00   1.276E-01  -3.390E+00   2.144E-01  -1.391E-01  -9.839E-02  -3.167E-04
       1.264E+00   9.680E-01  -6.232E-02  -2.581E+00   1.317E-01  -3.644E+00   2.276E-01  -3.506E-01  -8.126E-02  -1.225E-04
       1.436E+00   9.592E-01  -6.276E-02  -2.714E+00   1.400E-01  -3.728E+00   2.343E-01  -5.430E-01  -6.448E-02  -3.230E-05
       1.522E+00   9.597E-01  -6.351E-02  -2.813E+00   1.458E-01  -3.654E+00   2.362E-01  -6.544E-01  -5.500E-02  -4.848E-05];   
  

%**************************************************************************
% FIND C COEFFICIENTS BY INTERPOLATING BETWEEN PERDIODS
%**************************************************************************
ilow = min(find(period<=T));
T_low = period(ilow);
ihigh = max(find(period>=T));
T_high = period(ihigh);
% if given period equals a period in the table, then no need to interpolate
if ihigh==ilow
        c = cr(ihigh,:);
% otherwise, interpolate between coeffients
else
        c_high = cr(ihigh,:);
        c_low = cr(ilow,:);
    for i=1:length(c_high)
        c(i) = interp1([T_low T_high], [c_low(i) c_high(i)], T);
    end
end

%**************************************************************************
% COMPUTE LOG MEAN SPECTRAL ACCELERAION
%**************************************************************************
R0=10;
R1=70;
R2=140;
S=0; % for hard rock sites
f0 = max(log10(R0/Rcd),0);
f1 = min(log10(Rcd),log10(R1));
f2 = max(log10(Rcd/R2),0);

logSa = c(1) + c(2)*M + c(3)*M^2 +(c(4) + c(5)*M)*f1 + (c(6) + c(7)*M)*f2 +(c(8)+c(9)*M)*f0 + c(10)*Rcd+S; 

%**************************************************************************
% CONVERT SPECTRAL ACCELERATION FROM LOG SCALE (cgs units)
%**************************************************************************
Sa_cgs = (10^(logSa));

%**************************************************************************
% CONVERT SPECTRAL ACCELERATION IN G units
%**************************************************************************
if T==999
    Sa_2=Sa_cgs;
else
Sa_2 = Sa_cgs*(1/100)*(1/9.806);
end
%**************************************************************************
% DEFINE SIGMA TOTAL
%**************************************************************************
sigma_2=0.3;%0.3
